# text-to-MQTT
Converts text to MQTT messages sent to a broker.

This is to simplify the development of MQTT message generators by separating the tasks of generating content from sending the content via MQTT. The generating program needs to generate text for a set of topics and corresponding payload. This program converts that text into MQTT messages sent to a broker. This relieves the sensing program from having to deal with MQTT messaging and it centralizes the code for communicating with the broker.

This was developed on and for Raspberry Pi systems.

Text input is assumed to be of the form:

-topic: payload\n

-topic: payload\n

-...

The **topic** is string of characters that do NOT include white spaces or colon (':'). The **separator** consists of a colon character (':') followed by a space character (' '). The **payload** is an arbitrary string of characters. The '\n' is a new line character. The text can be generated by Python programs, bash scripts or other means.

The program connects to the broker, sends the messages in the input text list, and upon hitting the end-of-file for the input disconnects from the broker after a delay to allow the messages to be processed and acknowlegments to be received.

###Usage

```bash
text_generator | python txt2mqtt.py [-b <broker URL>] [--broker=] [-t <topic>] [--topic=<topic>] [-k] [--retain] [-h] [--help]
```

Options

-b  --broker= <broker URL>  optional URL specification of the broker defaulting to localhost:1883

-t  --topic=  <topic> supertopic prepended to the topic provided by the text generator. Defaults to 'hostname/' where hostname is the name of the current host as defined in /etc/hostname.

-q  --QOS=  <QOS> Quality of service indicator (0: at most once; 1: at least once; 2: exactly once). Defaults to at most once

-k  --retain   Boolean to select retention of message by broker. Defaults to no retention.

-h  --help  Print this help text
